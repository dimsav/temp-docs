<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Button and Form - EveryPay</title> <link rel="shortcut icon" href="https://dimsav.github.io/temp-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://dimsav.github.io/temp-docs/assets/css/just-the-docs.css"> <script type="text/javascript" src="https://dimsav.github.io/temp-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://dimsav.github.io/temp-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Button and Form | EveryPay</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Button and Form" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Online payment processing for internet and retail businesses. EveryPay offers payment APIs that powers commerce for businesses of all sizes." /> <meta property="og:description" content="Online payment processing for internet and retail businesses. EveryPay offers payment APIs that powers commerce for businesses of all sizes." /> <link rel="canonical" href="https://dimsav.github.io/temp-docs/button-and-payment-form/" /> <meta property="og:url" content="https://dimsav.github.io/temp-docs/button-and-payment-form/" /> <meta property="og:site_name" content="EveryPay" /> <script type="application/ld+json"> {"@type":"WebPage","headline":"Button and Form","description":"Online payment processing for internet and retail businesses. EveryPay offers payment APIs that powers commerce for businesses of all sizes.","url":"https://dimsav.github.io/temp-docs/button-and-payment-form/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://dimsav.github.iotemp-docs" class="site-title lh-tight"> EveryPay </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="https://dimsav.github.io/temp-docs/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="https://dimsav.github.io/temp-docs/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="https://dimsav.github.io/temp-docs/api/" class="navigation-list-link">API</a></li><li class="navigation-list-item active"><a href="https://dimsav.github.io/temp-docs/button-and-payment-form/" class="navigation-list-link active">Button and Form</a></li><li class="navigation-list-item"><a href="https://dimsav.github.io/temp-docs/payment-demo.html" class="navigation-list-link">Payment Demo</a></li><li class="navigation-list-item"><a href="https://dimsav.github.io/temp-docs/sandbox/" class="navigation-list-link">Sandbox</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search EveryPay" aria-label="Search EveryPay" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="button-and-form"> <a href="#button-and-form" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Button and Form </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#installation" id="markdown-toc-installation">Installation</a> <ol> <li><a href="#production" id="markdown-toc-production">Production</a></li> <li><a href="#sandbox" id="markdown-toc-sandbox">Sandbox</a></li> <li><a href="#inserting-the-button" id="markdown-toc-inserting-the-button">Inserting the button</a></li> <li><a href="#inserting-an-inline-form" id="markdown-toc-inserting-an-inline-form">Inserting an inline form</a></li> </ol> </li> <li><a href="#options" id="markdown-toc-options">Options</a> <ol> <li><a href="#global-options" id="markdown-toc-global-options">Global Options</a> <ol> <li><a href="#example" id="markdown-toc-example">Example</a></li> </ol> </li> <li><a href="#options-list" id="markdown-toc-options-list">Options List</a> <ol> <li><a href="#language-options" id="markdown-toc-language-options">Language Options</a></li> <li><a href="#payment-options" id="markdown-toc-payment-options">Payment Options</a></li> <li><a href="#button-options" id="markdown-toc-button-options">Button Options</a></li> <li><a href="#form-options" id="markdown-toc-form-options">Form Options</a></li> <li><a href="#inline-form-options" id="markdown-toc-inline-form-options">Inline Form Options</a></li> </ol> </li> <li><a href="#token-received-event-handler" id="markdown-toc-token-received-event-handler">Token Received Event handler</a></li> </ol> </li> </ol> <hr /> <p>EveryPay provides a script which is responsible for generating the frontend code required to let the customers fill the card form details securely.</p> <p>For security and legal reasons, the customer’s card details have to be inserted in a form provided by EveryPay within an iFrame. There are two ways of integrating a card form into a website:</p> <ol> <li>Using the Button</li> <li>Using the Inline Form</li> </ol> <h1 id="installation"> <a href="#installation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Installation </h1> <p>To install the script, we first need to insert the following code into the html part of our e-commerce site.</p> <h3 id="production"> <a href="#production" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Production </h3> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://button.everypay.gr/v2/js/everypay.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">everypay</span> <span class="o">=</span> <span class="nx">Everypay</span><span class="p">(</span><span class="dl">'</span><span class="s1">your-public-key</span><span class="dl">'</span><span class="p">,</span> <span class="nx">globalOptions</span><span class="p">)</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <h3 id="sandbox"> <a href="#sandbox" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Sandbox </h3> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://sandbox-button.everypay.gr/v2/js/everypay.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">everypay</span> <span class="o">=</span> <span class="nx">Everypay</span><span class="p">(</span><span class="dl">'</span><span class="s1">your-public-key</span><span class="dl">'</span><span class="p">,</span> <span class="nx">globalOptions</span><span class="p">)</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <h2 id="inserting-the-button"> <a href="#inserting-the-button" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Inserting the button </h2> <p>The button is the most popular way of adding a payment form. When the customer clicks the button, the payment form will appear.</p> <div class="code-example"> <form method="post" action="#"> <div id="button-container"></div> </form> <script src="https://sandbox-button.everypay.gr/v2/js/everypay.js"></script> <script> var everypay = Everypay('pk_YZ0QiK99FANXID6GIlIWHGA5Gh5GGQXH', {"amount": 1200, 'locale': 'en'}); everypay.button('#button-container'); </script> </div> <p>First, we need to add a container <code class="language-plaintext highlighter-rouge">#button-container</code> where the button will be inserted into. By default, the container needs to be inside an html <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> for the button to appear.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">"{url}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"button-container"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div> <p>Then, we tell EveryPay to insert the button in the container like so.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
    <span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-container</span><span class="dl">'</span><span class="p">,</span> <span class="nx">buttonOptions</span><span class="p">);</span> 
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <ul> <li>The first argument of the <code class="language-plaintext highlighter-rouge">everypay.button()</code> method is a string selector declaring where the button should be inserted into. You are free to choose any selector you want as long as the element exists on the page.</li> <li>The second argument of the <code class="language-plaintext highlighter-rouge">everypay.button()</code> method is an object containing the options of the button. Example: <code class="language-plaintext highlighter-rouge">buttonOptions = {amount: 100}</code>.</li> </ul> <h2 id="inserting-an-inline-form"> <a href="#inserting-an-inline-form" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Inserting an inline form </h2> <p>If we don’t want to show the card form as a popup modal, we can display the form directly into our merchant site. It will appear like so:</p> <div class="code-example"> <form method="post" action="#"> <div id="inline-container"></div> </form> <script> everypay.form('#inline-container'); </script> </div> <p>To insert the form, we need a container located inside an html <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code>.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">"#"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"inline-container"</span><span class="nt">&gt;&lt;/div&gt;</span> 
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script&gt;</span>
    <span class="nx">everypay</span><span class="p">.</span><span class="nx">form</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-container</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span> 
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <p>To learn more about how to define the options property, see the options page.</p> <h1 id="options"> <a href="#options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Options </h1> <h2 id="global-options"> <a href="#global-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Global Options </h2> <p>Global options are settings applied globally to all subsequent <code class="language-plaintext highlighter-rouge">everypay.button()</code> calls.</p> <p>If for instance you want to declare the <code class="language-plaintext highlighter-rouge">locale</code> “globally” for every button on the page, you can define it as a global option.</p> <p>When <code class="language-plaintext highlighter-rouge">everypay.button(selector, options)</code> is executed, the options object will be merged with the globalOptions object.</p> <h4 id="example"> <a href="#example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h4> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">everypay</span> <span class="o">=</span> <span class="nx">Everypay</span><span class="p">(</span><span class="dl">'</span><span class="s1">your-public-key</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">locale</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">el</span><span class="dl">'</span><span class="p">})</span>
    
    <span class="c1">// This will display a button with greek text</span>
    <span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-1</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
    
    <span class="c1">// This will display a second button with english text</span>
    <span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-2</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="dl">'</span><span class="s1">locale</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">en</span><span class="dl">'</span><span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <h2 id="options-list"> <a href="#options-list" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Options List </h2> <p>Here is the list of all available options. You may set these properties either as global or as button options.</p> <h3 id="language-options"> <a href="#language-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Language Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Key</th> <th style="text-align: left">Description</th> <th style="text-align: left">Default</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">locale</code></td> <td style="text-align: left">The language of the texts displayed to customers. Can be <code class="language-plaintext highlighter-rouge">'en'</code> or <code class="language-plaintext highlighter-rouge">'el'</code>.</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'el'</code></td> </tr> </tbody> </table></div> <h3 id="payment-options"> <a href="#payment-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Payment Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Key</th> <th style="text-align: left">Description</th> <th style="text-align: left">Default</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">amount</code> (required)</td> <td style="text-align: left">An integer declaring the amount in cents that will be charged.</td> <td style="text-align: left"> </td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">max_installments</code></td> <td style="text-align: left">An integer declaring the maximum number of installments.</td> <td style="text-align: left">0</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">txn_type</code></td> <td style="text-align: left">For advanced merchants only. Possible values <code class="language-plaintext highlighter-rouge">tds</code>, <code class="language-plaintext highlighter-rouge">no-tds</code>, <code class="language-plaintext highlighter-rouge">moto</code></td> <td style="text-align: left"> </td> </tr> </tbody> </table></div> <h3 id="button-options"> <a href="#button-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Button Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Key</th> <th style="text-align: left">Description</th> <th style="text-align: left">Default</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_text</code></td> <td style="text-align: left">The text displayed inside the button</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'Pay with card'</code> when english is selected.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_background_color</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">background-color</code></td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#2b6cb0'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_hover_background_color</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">hover:background-color</code></td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#2c5282'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_text_color</code></td> <td style="text-align: left">The color of the text</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#ffffff'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_hover_text_color</code></td> <td style="text-align: left">The color of the text on hover</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#ffffff'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_border_color</code></td> <td style="text-align: left">The color of the border</td> <td style="text-align: left">Defaults to the color of the background</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_hover_border_color</code></td> <td style="text-align: left">The color of the border on hover</td> <td style="text-align: left">Defaults to the color of the background on hover</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_full_width</code></td> <td style="text-align: left">A boolean indicating if the button should be a full width element</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_radius</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">border-radius</code></td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'4px'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_font_family</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">font-family</code></td> <td style="text-align: left"> </td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_font_weight</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">font-weight</code></td> <td style="text-align: left"> </td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">button_font_size</code></td> <td style="text-align: left">The value of the css property <code class="language-plaintext highlighter-rouge">font-size</code></td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'15px''</code></td> </tr> </tbody> </table></div> <h3 id="form-options"> <a href="#form-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Form Options </h3> <p>These settings apply both to the modal and the inline form.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Key</th> <th style="text-align: left">Description</th> <th style="text-align: left">Default</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">form_button_text</code></td> <td style="text-align: left">The text displayed in the button below the card form</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'Pay 12,00 €'</code> when english is selected.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">form_button_background_color</code></td> <td style="text-align: left">The color of the submit button below the card form</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#2b6cb0'</code></td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">form_button_text_color</code></td> <td style="text-align: left">The text color of the submit button below the card form</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">'#ffffff'</code></td> </tr> </tbody> </table></div> <h3 id="inline-form-options"> <a href="#inline-form-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Inline Form Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Key</th> <th style="text-align: left">Description</th> <th style="text-align: left">Default</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">form_button_hide</code></td> <td style="text-align: left">Boolean to indicate whether the button below the card form should be hidden. This can be useful when the inline form is submitted programmatically.</td> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">false</code></td> </tr> </tbody> </table></div> <h2 id="token-received-event-handler"> <a href="#token-received-event-handler" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Token Received Event handler </h2> <p>It is possible to define a function that is executed by EveryPay’s script when the card form generates a valid card token.</p> <p>When a card token is generated, the default behavior of EveryPay’s script is to append the token as a hidden input and submit the html form in the merchant’s site. To provide a better user experience, we might want to change this default behavior and do something custom.</p> <p>A typical example would be to attempt to make the payment with an ajax request and if the payment fails, to show an error inside the card form and let the user enter a different card.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
    <span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-container</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">on_token_received</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">showError</span><span class="p">,</span> <span class="nx">hideForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// We got a card token. Let's try to make the payment...</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">paymentWasSuccessful</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">hideForm</span><span class="p">()</span> <span class="c1">// close modal</span>
                <span class="c1">// show success message</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">showError</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invalid card</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// show error on card form</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span> 
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <p>The three arguments provided by EveryPay are:</p> <ol> <li><code class="language-plaintext highlighter-rouge">token</code>: Contains the card token as a string.</li> <li><code class="language-plaintext highlighter-rouge">showError</code>: This is a function that displays an error inside the card form</li> <li><code class="language-plaintext highlighter-rouge">hideForm</code>: This closes the card form modal</li> </ol> <p><strong>showError(string)</strong></p> <p>The function <code class="language-plaintext highlighter-rouge">showError()</code> accepts an error argument that can have two types:</p> <p>A string containing the error message to display. This will place the input string right below the card input. If <code class="language-plaintext highlighter-rouge">showError('Invalid card')</code> is executed, then the message will appear like so:</p> <p><img src="https://dimsav.github.io/temp-docs/assets/img/screen-1.png" alt="Invalid card" /></p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-container</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">on_token_received</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">showError</span><span class="p">,</span> <span class="nx">hideForm</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// failed ajax request</span>
    <span class="nx">showError</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invalid card</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">});</span> 
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <p><strong>showError(object)</strong></p> <p>The function <code class="language-plaintext highlighter-rouge">showError()</code> can also accept an error object returned by the EveryPay API payment request.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="nx">everypay</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="dl">'</span><span class="s1">#button-container</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">on_token_received</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">showError</span><span class="p">,</span> <span class="nx">hideForm</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">paymentResponse</span> <span class="o">=</span> <span class="nx">ajaxPaymentToMerchantBackend</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span>
        <span class="c1">// var paymentResponse = {"error": {</span>
        <span class="c1">//      "status": 401,</span>
        <span class="c1">//      "message": "Client should contact issuing bank",</span>
        <span class="c1">//      "code": 40060</span>
        <span class="c1">//   }};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">paymentResponse</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">showError</span><span class="p">(</span><span class="nx">paymentResponse</span><span class="p">)</span>    
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">success-url</span><span class="dl">'</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span> 
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <p><img src="https://dimsav.github.io/temp-docs/assets/img/screen-2.png" alt="Invalid card" /></p> <p>The showError will return a user friendly message, depending on the error code we received from the payment API call.</p> </div> </div> </div> </div> </body> </html>
